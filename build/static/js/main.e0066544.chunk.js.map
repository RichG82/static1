{"version":3,"sources":["authConfig.js","components/SignInButton.jsx","components/SignOutButton.jsx","components/PageLayout.jsx","components/ProfileData.jsx","graph.js","App.jsx","index.js"],"names":["msalConfig","auth","clientId","authority","redirectUri","cache","cacheLocation","storeAuthStateInCookie","system","loggerOptions","loggerCallback","level","message","containsPii","LogLevel","Error","console","error","Info","info","Verbose","debug","Warning","warn","loginRequest","scopes","graphConfig","SignInButton","instance","useMsal","handleLogin","loginType","loginPopup","catch","e","log","loginRedirect","DropdownButton","variant","className","drop","title","Dropdown","Item","as","onClick","SignOutButton","handleLogout","logoutType","logoutPopup","postLogoutRedirectUri","mainWindowRedirectUri","logoutRedirect","PageLayout","props","isAuthenticated","useIsAuthenticated","Navbar","bg","href","children","ProfileData","graphData","id","givenName","surname","userPrincipalName","accessToken","a","headers","Headers","bearer","append","options","method","fetch","then","response","json","ProfileContent","accounts","useState","setGraphData","name","Button","acquireTokenSilent","account","callMsGraph","MainContent","App","msalInstance","PublicClientApplication","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.e0066544.chunk.js","sourcesContent":["/*\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License.\r\n */\r\n\r\nimport { LogLevel } from \"@azure/msal-browser\";\r\n\r\n/**\r\n * Configuration object to be passed to MSAL instance on creation. \r\n * For a full list of MSAL.js configuration parameters, visit:\r\n * https://github.com/AzureAD/microsoft-authentication-library-for-js/blob/dev/lib/msal-browser/docs/configuration.md \r\n */\r\nexport const msalConfig = {\r\n    auth: {\r\n        clientId: \"Enter_the_Application_Id_Here\",\r\n        authority: \"Enter_the_Cloud_Instance_Id_HereEnter_the_Tenant_Info_Here\",\r\n        redirectUri: \"Enter_the_Redirect_Uri_Here\"\r\n    },\r\n    cache: {\r\n        cacheLocation: \"sessionStorage\", // This configures where your cache will be stored\r\n        storeAuthStateInCookie: false, // Set this to \"true\" if you are having issues on IE11 or Edge\r\n    },\r\n    system: {\t\r\n        loggerOptions: {\t\r\n            loggerCallback: (level, message, containsPii) => {\t\r\n                if (containsPii) {\t\t\r\n                    return;\t\t\r\n                }\t\t\r\n                switch (level) {\t\t\r\n                    case LogLevel.Error:\t\t\r\n                        console.error(message);\t\t\r\n                        return;\t\t\r\n                    case LogLevel.Info:\t\t\r\n                        console.info(message);\t\t\r\n                        return;\t\t\r\n                    case LogLevel.Verbose:\t\t\r\n                        console.debug(message);\t\t\r\n                        return;\t\t\r\n                    case LogLevel.Warning:\t\t\r\n                        console.warn(message);\t\t\r\n                        return;\t\t\r\n                }\t\r\n            }\t\r\n        }\t\r\n    }\r\n};\r\n\r\n/**\r\n * Scopes you add here will be prompted for user consent during sign-in.\r\n * By default, MSAL.js will add OIDC scopes (openid, profile, email) to any login request.\r\n * For more information about OIDC scopes, visit: \r\n * https://docs.microsoft.com/en-us/azure/active-directory/develop/v2-permissions-and-consent#openid-connect-scopes\r\n */\r\nexport const loginRequest = {\r\n    scopes: [\"User.Read\"]\r\n};\r\n\r\n/**\r\n * Add here the scopes to request when obtaining an access token for MS Graph API. For more information, see:\r\n * https://github.com/AzureAD/microsoft-authentication-library-for-js/blob/dev/lib/msal-browser/docs/resources-and-scopes.md\r\n */\r\nexport const graphConfig = {\r\n    graphMeEndpoint: \"Enter_the_Graph_Endpoint_Herev1.0/me\"\r\n};\r\n","import React from \"react\";\r\nimport { useMsal } from \"@azure/msal-react\";\r\nimport { loginRequest } from \"../authConfig\";\r\nimport DropdownButton from \"react-bootstrap/DropdownButton\";\r\nimport Dropdown from \"react-bootstrap/esm/Dropdown\";\r\n\r\n/**\r\n * Renders a drop down button with child buttons for logging in with a popup or redirect\r\n */\r\nexport const SignInButton = () => {\r\n    const { instance } = useMsal();\r\n\r\n    const handleLogin = (loginType) => {\r\n        if (loginType === \"popup\") {\r\n            instance.loginPopup(loginRequest).catch(e => {\r\n                console.log(e);\r\n            });\r\n        } else if (loginType === \"redirect\") {\r\n            instance.loginRedirect(loginRequest).catch(e => {\r\n                console.log(e);\r\n            });\r\n        }\r\n    }\r\n    return (\r\n        <DropdownButton variant=\"secondary\" className=\"ml-auto\" drop=\"left\" title=\"Sign In\">\r\n            <Dropdown.Item as=\"button\" onClick={() => handleLogin(\"popup\")}>Sign in using Popup</Dropdown.Item>\r\n            <Dropdown.Item as=\"button\" onClick={() => handleLogin(\"redirect\")}>Sign in using Redirect</Dropdown.Item>\r\n        </DropdownButton>\r\n    )\r\n}","import React from \"react\";\r\nimport { useMsal } from \"@azure/msal-react\";\r\nimport DropdownButton from \"react-bootstrap/DropdownButton\";\r\nimport Dropdown from \"react-bootstrap/esm/Dropdown\";\r\n\r\n/**\r\n * Renders a sign-out button\r\n */\r\nexport const SignOutButton = () => {\r\n    const { instance } = useMsal();\r\n\r\n    const handleLogout = (logoutType) => {\r\n        if (logoutType === \"popup\") {\r\n            instance.logoutPopup({\r\n                postLogoutRedirectUri: \"/\",\r\n                mainWindowRedirectUri: \"/\"\r\n            });\r\n        } else if (logoutType === \"redirect\") {\r\n            instance.logoutRedirect({\r\n                postLogoutRedirectUri: \"/\",\r\n            });\r\n        }\r\n    }\r\n    return (\r\n        <DropdownButton variant=\"secondary\" className=\"ml-auto\" drop=\"left\" title=\"Sign Out\">\r\n            <Dropdown.Item as=\"button\" onClick={() => handleLogout(\"popup\")}>Sign out using Popup</Dropdown.Item>\r\n            <Dropdown.Item as=\"button\" onClick={() => handleLogout(\"redirect\")}>Sign out using Redirect</Dropdown.Item>\r\n        </DropdownButton>\r\n    )\r\n}","/*\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License.\r\n */\r\n\r\nimport React from \"react\";\r\nimport Navbar from \"react-bootstrap/Navbar\";\r\n\r\nimport { useIsAuthenticated } from \"@azure/msal-react\";\r\nimport { SignInButton } from \"./SignInButton\";\r\nimport { SignOutButton } from \"./SignOutButton\";\r\n\r\n/**\r\n * Renders the navbar component with a sign-in or sign-out button depending on whether or not a user is authenticated\r\n * @param props \r\n */\r\nexport const PageLayout = (props) => {\r\n    const isAuthenticated = useIsAuthenticated();\r\n\r\n    return (\r\n        <>\r\n            <Navbar bg=\"primary\" variant=\"dark\">\r\n                <a className=\"navbar-brand\" href=\"/\">Microsoft Identity Platform</a>\r\n                { isAuthenticated ? <SignOutButton /> : <SignInButton /> }\r\n            </Navbar>\r\n            <h5><center>Welcome to the Microsoft Authentication Library For Javascript - React Quickstart</center></h5>\r\n            <br />\r\n            <br />\r\n            {props.children}\r\n        </>\r\n    );\r\n};\r\n","import React from \"react\";\r\n\r\n/**\r\n * Renders information about the user obtained from MS Graph\r\n * @param props \r\n */\r\nexport const ProfileData = (props) => {\r\n    console.log(props.graphData);\r\n\r\n    return (\r\n        <div id=\"profile-div\">\r\n            <p><strong>First Name: </strong> {props.graphData.givenName}</p>\r\n            <p><strong>Last Name: </strong> {props.graphData.surname}</p>\r\n            <p><strong>Email: </strong> {props.graphData.userPrincipalName}</p>\r\n            <p><strong>Id: </strong> {props.graphData.id}</p>\r\n        </div>\r\n    );\r\n};","import { graphConfig } from \"./authConfig\";\r\n\r\n/**\r\n * Attaches a given access token to a MS Graph API call. Returns information about the user\r\n * @param accessToken \r\n */\r\nexport async function callMsGraph(accessToken) {\r\n    const headers = new Headers();\r\n    const bearer = `Bearer ${accessToken}`;\r\n\r\n    headers.append(\"Authorization\", bearer);\r\n\r\n    const options = {\r\n        method: \"GET\",\r\n        headers: headers\r\n    };\r\n\r\n    return fetch(graphConfig.graphMeEndpoint, options)\r\n        .then(response => response.json())\r\n        .catch(error => console.log(error));\r\n}\r\n","import React, { useState } from \"react\";\r\nimport { AuthenticatedTemplate, UnauthenticatedTemplate, useMsal } from \"@azure/msal-react\";\r\nimport { loginRequest } from \"./authConfig\";\r\nimport { PageLayout } from \"./components/PageLayout\";\r\nimport { ProfileData } from \"./components/ProfileData\";\r\nimport { callMsGraph } from \"./graph\";\r\nimport Button from \"react-bootstrap/Button\";\r\nimport \"./styles/App.css\";\r\n\r\n/**\r\n * Renders information about the signed-in user or a button to retrieve data about the user\r\n */\r\nconst ProfileContent = () => {\r\n    const { instance, accounts } = useMsal();\r\n    const [graphData, setGraphData] = useState(null);\r\n\r\n    function RequestProfileData() {\r\n        // Silently acquires an access token which is then attached to a request for MS Graph data\r\n        instance.acquireTokenSilent({\r\n            ...loginRequest,\r\n            account: accounts[0]\r\n        }).then((response) => {\r\n            callMsGraph(response.accessToken).then(response => setGraphData(response));\r\n        });\r\n    }\r\n\r\n    return (\r\n        <>\r\n            <h5 className=\"card-title\">Welcome {accounts[0].name}</h5>\r\n            {graphData ? \r\n                <ProfileData graphData={graphData} />\r\n                :\r\n                <Button variant=\"secondary\" onClick={RequestProfileData}>Request Profile Information</Button>\r\n            }\r\n        </>\r\n    );\r\n};\r\n\r\n/**\r\n * If a user is authenticated the ProfileContent component above is rendered. Otherwise a message indicating a user is not authenticated is rendered.\r\n */\r\nconst MainContent = () => {    \r\n    return (\r\n        <div className=\"App\">\r\n            <AuthenticatedTemplate>\r\n                <ProfileContent />\r\n            </AuthenticatedTemplate>\r\n\r\n            <UnauthenticatedTemplate>\r\n                <h5 className=\"card-title\">Please sign-in to see your profile information.</h5>\r\n            </UnauthenticatedTemplate>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default function App() {\r\n    return (\r\n        <PageLayout>\r\n            <MainContent />\r\n        </PageLayout>\r\n    );\r\n}\r\n","import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport \"bootstrap/dist/css/bootstrap.min.css\";\r\nimport \"./styles/index.css\";\r\nimport App from \"./App.jsx\";\r\nimport { PublicClientApplication } from \"@azure/msal-browser\";\r\nimport { MsalProvider } from \"@azure/msal-react\";\r\nimport { msalConfig } from \"./authConfig\";\r\n\r\n/**\r\n * Initialize a PublicClientApplication instance which is provided to the MsalProvider component\r\n * We recommend initializing this outside of your root component to ensure it is not re-initialized on re-renders\r\n */\r\nconst msalInstance = new PublicClientApplication(msalConfig);\r\n\r\n/**\r\n * We recommend wrapping most or all of your components in the MsalProvider component. It's best to render the MsalProvider as close to the root as possible.\r\n */\r\nReactDOM.render(\r\n    <React.StrictMode>\r\n        <MsalProvider instance={msalInstance}>\r\n            <App />\r\n        </MsalProvider>\r\n    </React.StrictMode>,\r\n    document.getElementById(\"root\")\r\n);\r\n"],"sourceRoot":""}